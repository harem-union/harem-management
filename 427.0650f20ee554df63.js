"use strict";(self.webpackChunkgame_management=self.webpackChunkgame_management||[]).push([[427],{9427:(v,m,i)=>{i.r(m),i.d(m,{MapViewComponent:()=>b});var e=i(4438),c=i(177),l=i(9417),g=i(4616),h=i(8132),u=i(5036),p=i(1413);let b=(()=>{class d{constructor(){this.gameService=(0,e.WQX)(u.w),this.translateService=(0,e.WQX)(g.c$),this.destroy$=new p.B,this.selectedDirection="all",this.teamFilters={all:!0,A:!0,B:!0,C:!0,D:!0},this.selectedCell=null,this.chartOption={},this.chartWidth=600,this.chartHeight=600,this.size=600,this.option={backgroundColor:"transparent",animation:!0,animationDuration:1500,animationEasing:"cubicOut",tooltip:{trigger:"item",backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"#ffffff",borderWidth:1,textStyle:{color:"#ffffff",fontSize:12},formatter:t=>{if("scatter"===t.seriesType){if(t.data.weapon&&t.data.team)return`\n                <div style="padding: 12px; border-radius: 8px;">\n                  <div style="font-weight: bold; color: #fbbf24; margin-bottom: 8px;">${this.translateService.instant("PLAYER")}: ${t.data.name}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("UID")}:</strong> ${t.data.uid}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("TEAM")}:</strong> <span style="color: ${this.getTeamColor(t.data.team)};">${t.data.team}</span></div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("RANK")}:</strong> ${t.data.rank}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("WEAPON")}:</strong> ${this.translateService.instant(t.data.weapon)}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("COORDINATES")}:</strong> X: ${t.value[0]}, Y: ${t.value[1]}</div>\n                </div>\n              `;if(t.data.weapon&&!t.data.team)return`\n                <div style="padding: 12px; border-radius: 8px;">\n                  <div style="font-weight: bold; color: #fbbf24; margin-bottom: 8px;">${this.translateService.instant("WEAPON")}: ${t.data.weapon}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("UID")}:</strong> ${t.data.uid}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("WEAPON_TYPE")}:</strong> ${this.translateService.instant(t.data.weapon_type)}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("LEVEL")}:</strong> ${t.data.level}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("COORDINATES")}:</strong> X: ${t.value[0]}, Y: ${t.value[1]}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("STATUS")}:</strong> <span style="color: #10b981;">${this.translateService.instant("AVAILABLE")}</span></div>\n                </div>\n              `;if(t.data.team)return`\n                <div style="padding: 12px; border-radius: 8px;">\n                  <div style="font-weight: bold; color: #fbbf24; margin-bottom: 8px;">${this.translateService.instant("PLAYER")}: ${t.data.name}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("UID")}:</strong> ${t.data.uid}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("TEAM")}:</strong> <span style="color: ${this.getTeamColor(t.data.team)};">${t.data.team}</span></div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("RANK")}:</strong> ${t.data.rank||"N/A"}</div>\n                  <div style="margin-bottom: 4px;"><strong>${this.translateService.instant("COORDINATES")}:</strong> X: ${t.value[0]}, Y: ${t.value[1]}</div>\n                </div>\n              `}return""}},grid:{top:20,left:40,right:20,bottom:40,backgroundColor:"rgba(255, 255, 255, 0.02)",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1},xAxis:{type:"value",min:0,max:this.size-1,splitNumber:12,axisLabel:{show:!0,color:"#9ca3af",fontSize:10,formatter:function(t){return t%50==0?t.toString():""}},axisLine:{lineStyle:{color:"#374151"}},splitLine:{show:!0,lineStyle:{color:"rgba(156, 163, 175, 0.2)",type:"solid",width:1}}},yAxis:{type:"value",min:0,max:this.size-1,splitNumber:12,axisLabel:{show:!0,color:"#9ca3af",fontSize:10,formatter:function(t){return t%50==0?t.toString():""}},axisLine:{lineStyle:{color:"#374151"}},splitLine:{show:!0,lineStyle:{color:"rgba(156, 163, 175, 0.2)",type:"solid",width:1}}},series:[{type:"scatter",data:this.buildMarkers(),emphasis:{itemStyle:{borderColor:"#ffffff",borderWidth:3,shadowBlur:15,shadowColor:"rgba(0, 0, 0, 0.5)",shadowOffsetX:0,shadowOffsetY:4},scale:!0},animation:!0,animationDuration:1e3,animationEasing:"cubicOut"}]}}ngAfterViewInit(){this.refreshData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}refreshData(){this.gameService.refreshData(),setTimeout(()=>{this.updateChart()},1e3)}updateChart(){const t=this.buildMarkers();console.log("Updated markers:",t),this.option={...this.option,series:[{type:"scatter",data:t,emphasis:{itemStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"}}}]}}buildHeatmap(){const t=[];for(let s=0;s<this.size;s++)for(let r=0;r<this.size;r++)t.push([s,r,Math.random()]);return t}buildMarkers(){const t=this.gameService.players(),s=this.gameService.weapons(),r=[];return console.log("Players:",t),console.log("Weapons:",s),t.forEach(a=>{const n=s.find(o=>o.uid===a.uid);n&&null!==n.x_coordinate&&null!==n.y_coordinate&&this.teamFilters[a.team]&&r.push({name:a.nickname||"Unknown",value:[n.x_coordinate,n.y_coordinate],uid:a.uid,team:a.team,role:a.role_in_game||a.role||"N/A",rank:a.rank_level||"N/A",paying:a.is_paying_player?"\u0e43\u0e0a\u0e48":"\u0e44\u0e21\u0e48",status:"active"===a.status?"\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19":"\u0e44\u0e21\u0e48\u0e43\u0e0a\u0e49\u0e07\u0e32\u0e19",weapon:n?.weapon_type||"N/A",itemStyle:{color:this.getTeamColor(a.team),borderColor:"#ffffff",borderWidth:2,shadowBlur:8,shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffsetX:0,shadowOffsetY:2,borderRadius:50},symbolSize:20,symbolOffset:[0,0]})}),s.forEach(a=>{if(null!==a.x_coordinate&&null!==a.y_coordinate){const n=t.find(o=>o.uid===a.uid);r.push({name:n?.nickname||"Unknown Weapon",value:[a.x_coordinate,a.y_coordinate],uid:a.uid,team:n?.team||"N/A",rank:n?.rank_level||"N/A",weapon:this.translateService.instant(a.weapon_type)||"N/A",weapon_type:a.weapon_type||"N/A",itemStyle:{color:"#fbbf24",borderColor:"#ffffff",borderWidth:2,shadowBlur:10,shadowColor:"rgba(251, 191, 36, 0.4)",shadowOffsetX:0,shadowOffsetY:3,borderRadius:4},symbol:this.getWeaponIcon(a.weapon_type),symbolSize:40,symbolOffset:[0,-20]})}}),console.log("Generated points:",r),r}onChartClick(t){this.selectedCell={x:t.value[0],y:t.value[1],player:t.data,weapon:"\u0e2d\u0e32\u0e27\u0e38\u0e18"===t.seriesName?t.data:null}}getTeamColor(t){switch(t){case"A":return"#ef4444";case"B":return"#3b82f6";case"C":return"#10b981";case"D":return"#8b5cf6";default:return"#6b7280"}}updateTeamFilters(t){if("all"===t){const s=this.teamFilters.all;this.teamFilters.A=s,this.teamFilters.B=s,this.teamFilters.C=s,this.teamFilters.D=s}else this.teamFilters.all=this.teamFilters.A&&this.teamFilters.B&&this.teamFilters.C&&this.teamFilters.D;this.updateChart()}get chartOptions(){return this.chartOption}get totalPlayers(){return this.gameService.players().length}get totalWeapons(){return this.gameService.weapons().length}get activePlayers(){return this.gameService.players().filter(t=>"active"===t.status).length}getWeaponIcon(t){if(!t)return"circle";switch(console.log("Weapon Type:",t),t){case"LONGBOW":case"CROSSBOW":case"TOXIBOW":case"HUNTER":case"IMPROVED_CROSSBOW":case"FIRE_BOW":return"image://assets/weapon/bow.png";case"SABER_SHIELD":case"HEAVY_SHIELD":case"SPEAR_SHIELD":case"HAMMER_SHIELD":case"SWORD_SHIELD":return"image://assets/weapon/shield.png";case"SWORD_CAVALRY":case"SPEAR_CAVALRY":case"BROADSWORD_CAVALRY":case"HAAVY_CALVARY":case"BOW_CALVARY":case"AXE_CAVALRY":return"image://assets/weapon/horse.png";case"LONG_SPEAR":case"LANCER":case"DAGGER_AXE":case"MADAO":case"LONG_SWORDSMAN":case"LONG_SPEAR":return"image://assets/weapon/spear.png";default:return"circle"}}static{this.\u0275fac=function(s){return new(s||d)}}static{this.\u0275cmp=e.VBU({type:d,selectors:[["app-map-view"]],standalone:!0,features:[e.aNF],decls:106,vars:57,consts:[[1,"space-y-6","opacity-bg-main","rounded-lg","p-6","shadow-lg"],[1,"opacity-bg-header","shadow","rounded-lg","p-4","sm:p-6"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","sm:text-base","text-gray-600","dark:text-gray-400"],[1,"opacity-bg-card","shadow-lg","rounded-xl","p-6","sm:p-8","border","border-gray-200/50","dark:border-gray-700/50","backdrop-blur-sm"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-6"],[1,"flex","items-center","space-x-3","mb-4","sm:mb-0"],[1,"p-2","bg-gray-600","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m-6 3l6-3"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-600","dark:text-gray-400","mt-1"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-white/50","dark:bg-gray-800/50","rounded-xl","p-6","border","border-gray-200/50","dark:border-gray-700/50"],[1,"flex","items-center","space-x-3","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-lg","font-bold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3"],[1,"space-y-3"],[1,"flex","items-center","cursor-pointer","p-3","rounded-lg","transition-all","duration-200","hover:bg-gray-50","dark:hover:bg-gray-700/50","border","border-transparent","hover:border-gray-200","dark:hover:border-gray-600"],["type","checkbox","checked","",1,"form-checkbox","h-5","w-5","mr-4","text-gray-600","bg-gray-100","border-gray-300","rounded","focus:ring-gray-500","focus:ring-2",3,"ngModelChange","change","ngModel"],[1,"text-base","font-semibold","text-gray-700","dark:text-gray-300"],["type","checkbox","checked","",1,"form-checkbox","h-5","w-5","mr-4","text-red-600","bg-gray-100","border-gray-300","rounded","focus:ring-red-500","focus:ring-2",3,"ngModelChange","change","ngModel"],[1,"flex","items-center","space-x-2"],[1,"w-3","h-3","bg-red-500","rounded-full"],["type","checkbox","checked","",1,"form-checkbox","h-5","w-5","mr-4","text-blue-600","bg-gray-100","border-gray-300","rounded","focus:ring-blue-500","focus:ring-2",3,"ngModelChange","change","ngModel"],[1,"w-3","h-3","bg-blue-500","rounded-full"],["type","checkbox","checked","",1,"form-checkbox","h-5","w-5","mr-4","text-green-600","bg-gray-100","border-gray-300","rounded","focus:ring-green-500","focus:ring-2",3,"ngModelChange","change","ngModel"],[1,"w-3","h-3","bg-green-500","rounded-full"],["type","checkbox",1,"form-checkbox","h-5","w-5","mr-4","text-purple-600","bg-gray-100","border-gray-300","rounded","focus:ring-purple-500","focus:ring-2",3,"ngModelChange","change","ngModel"],[1,"w-3","h-3","bg-purple-500","rounded-full"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","items-center","space-x-3","p-2"],[1,"w-4","h-4","bg-red-500","rounded-full","border-2","border-white","shadow-sm"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"w-4","h-4","bg-blue-500","rounded-full","border-2","border-white","shadow-sm"],[1,"w-4","h-4","bg-purple-500","rounded-full","border-2","border-white","shadow-sm"],[1,"opacity-bg-card","shadow","rounded-lg","p-4","sm:p-6"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900","dark:text-white","mb-2","sm:mb-0"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"relative","opacity-bg-map-container","rounded-lg","p-4","sm:p-6","overflow-hidden"],[1,"absolute","inset-0","border-2","opacity-bg-map-border","rounded-lg"],[1,"relative","w-full","h-full"],["echarts","",2,"height","800px","width","100%",3,"options"]],template:function(s,r){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"p",3),e.EFF(6),e.nI1(7,"translate"),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7),e.qSk(),e.j41(13,"svg",8),e.nrm(14,"path",9),e.k0s()(),e.joV(),e.j41(15,"div")(16,"h3",10),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.j41(19,"p",11),e.EFF(20),e.nI1(21,"translate"),e.k0s()()()(),e.j41(22,"div",12)(23,"div",13)(24,"div",14)(25,"div",7),e.qSk(),e.j41(26,"svg",15),e.nrm(27,"path",16),e.k0s()(),e.joV(),e.j41(28,"h3",17),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.j41(31,"div",18)(32,"div",19)(33,"label",20)(34,"input",21),e.mxI("ngModelChange",function(n){return e.DH7(r.teamFilters.all,n)||(r.teamFilters.all=n),n}),e.bIt("change",function(){return r.updateTeamFilters("all")}),e.k0s(),e.j41(35,"span",22),e.EFF(36),e.nI1(37,"translate"),e.k0s()(),e.j41(38,"label",20)(39,"input",23),e.mxI("ngModelChange",function(n){return e.DH7(r.teamFilters.A,n)||(r.teamFilters.A=n),n}),e.bIt("change",function(){return r.updateTeamFilters("A")}),e.k0s(),e.j41(40,"div",24),e.nrm(41,"div",25),e.j41(42,"span",22),e.EFF(43),e.nI1(44,"translate"),e.k0s()()(),e.j41(45,"label",20)(46,"input",26),e.mxI("ngModelChange",function(n){return e.DH7(r.teamFilters.B,n)||(r.teamFilters.B=n),n}),e.bIt("change",function(){return r.updateTeamFilters("B")}),e.k0s(),e.j41(47,"div",24),e.nrm(48,"div",27),e.j41(49,"span",22),e.EFF(50),e.nI1(51,"translate"),e.k0s()()()(),e.j41(52,"div",19)(53,"label",20)(54,"input",28),e.mxI("ngModelChange",function(n){return e.DH7(r.teamFilters.C,n)||(r.teamFilters.C=n),n}),e.bIt("change",function(){return r.updateTeamFilters("C")}),e.k0s(),e.j41(55,"div",24),e.nrm(56,"div",29),e.j41(57,"span",22),e.EFF(58),e.nI1(59,"translate"),e.k0s()()(),e.j41(60,"label",20)(61,"input",30),e.mxI("ngModelChange",function(n){return e.DH7(r.teamFilters.D,n)||(r.teamFilters.D=n),n}),e.bIt("change",function(){return r.updateTeamFilters("D")}),e.k0s(),e.j41(62,"div",24),e.nrm(63,"div",31),e.j41(64,"span",22),e.EFF(65),e.nI1(66,"translate"),e.k0s()()()()()(),e.j41(67,"div",13)(68,"div",14)(69,"div",7),e.qSk(),e.j41(70,"svg",15),e.nrm(71,"path",32),e.k0s()(),e.joV(),e.j41(72,"h3",17),e.EFF(73),e.nI1(74,"translate"),e.k0s()(),e.j41(75,"div",18)(76,"div",19)(77,"div",33),e.nrm(78,"div",34),e.j41(79,"span",35),e.EFF(80),e.nI1(81,"translate"),e.k0s()(),e.j41(82,"div",33),e.nrm(83,"div",36),e.j41(84,"span",35),e.EFF(85),e.nI1(86,"translate"),e.k0s()()(),e.j41(87,"div",19)(88,"div",33),e.nrm(89,"div",37),e.j41(90,"span",35),e.EFF(91),e.nI1(92,"translate"),e.k0s()()()()()()(),e.j41(93,"div",38)(94,"div",39)(95,"h3",40),e.EFF(96),e.nI1(97,"translate"),e.k0s(),e.j41(98,"div",41)(99,"span",42),e.EFF(100),e.nI1(101,"translate"),e.k0s()()(),e.j41(102,"div",43),e.nrm(103,"div",44),e.j41(104,"div",45),e.nrm(105,"div",46),e.k0s()()()()),2&s&&(e.R7$(3),e.SpI(" ",e.bMT(4,23,"MAP_VIEWER")," "),e.R7$(3),e.Lme(" ",e.bMT(7,25,"MAP_VIEW")," - ",e.bMT(8,27,"GAME_MANAGEMENT")," "),e.R7$(11),e.SpI(" ",e.bMT(18,29,"MAP_CONTROLS")," "),e.R7$(3),e.SpI(" ",e.bMT(21,31,"MANAGE_GAME_MAP")," "),e.R7$(9),e.SpI(" ",e.bMT(30,33,"TEAM_FILTER")," "),e.R7$(5),e.R50("ngModel",r.teamFilters.all),e.R7$(2),e.JRh(e.bMT(37,35,"ALL_TEAM")),e.R7$(3),e.R50("ngModel",r.teamFilters.A),e.R7$(4),e.JRh(e.bMT(44,37,"TEAM_A")),e.R7$(3),e.R50("ngModel",r.teamFilters.B),e.R7$(4),e.JRh(e.bMT(51,39,"TEAM_B")),e.R7$(4),e.R50("ngModel",r.teamFilters.C),e.R7$(4),e.JRh(e.bMT(59,41,"TEAM_C")),e.R7$(3),e.R50("ngModel",r.teamFilters.D),e.R7$(4),e.JRh(e.bMT(66,43,"TEAM_D")),e.R7$(8),e.SpI(" ",e.bMT(74,45,"MAP_LEGEND")," "),e.R7$(7),e.JRh(e.bMT(81,47,"TEAM_A_PLAYERS")),e.R7$(5),e.JRh(e.bMT(86,49,"TEAM_B_PLAYERS")),e.R7$(6),e.JRh(e.bMT(92,51,"TEAM_D_PLAYERS")),e.R7$(5),e.JRh(e.bMT(97,53,"MAP_VIEWER")),e.R7$(4),e.SpI(" ",e.bMT(101,55,"COORDINATES"),": X: 0-599, Y: 0-599 "),e.R7$(5),e.Y8G("options",r.option))},dependencies:[c.MD,l.YN,l.Zm,l.BC,l.vS,g.h,g.D9,h.sN,h.$P],encapsulation:2})}}return d})()}}]);