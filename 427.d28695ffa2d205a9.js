"use strict";(self.webpackChunkgame_management=self.webpackChunkgame_management||[]).push([[427],{9427:(E,u,h)=>{h.r(u),h.d(u,{MapViewComponent:()=>k});var e=h(4438),b=h(177),c=h(9417),M=h(7408),_=h(5036);const f=["mapCanvas"];function v(r,g){if(1&r&&(e.j41(0,"div",37)(1,"div",38),e.EFF(2),e.k0s()()),2&r){const s=e.XpG();e.xc7("left",s.tooltipX,"px")("top",s.tooltipY,"px"),e.R7$(2),e.JRh(s.tooltipText)}}function C(r,g){if(1&r&&(e.j41(0,"div",40)(1,"p",41),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",42),e.EFF(5),e.k0s(),e.j41(6,"p",44),e.EFF(7),e.k0s()()),2&r){const s=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,3,"PLAYER")),e.R7$(3),e.JRh(s.selectedCell.player.gameName),e.R7$(2),e.JRh(s.selectedCell.player.uid)}}function x(r,g){if(1&r&&(e.j41(0,"div",40)(1,"p",41),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"p",42),e.EFF(5),e.k0s(),e.j41(6,"p",44),e.EFF(7),e.k0s()()),2&r){const s=e.XpG(2);e.R7$(2),e.JRh(e.bMT(3,3,"WEAPON")),e.R7$(3),e.JRh(s.selectedCell.weapon.weaponType),e.R7$(2),e.JRh(s.selectedCell.weapon.position)}}function R(r,g){if(1&r&&(e.j41(0,"div",2)(1,"h3",7),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.j41(4,"div",39)(5,"div",40)(6,"p",41),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.j41(9,"p",42),e.EFF(10),e.k0s()(),e.DNE(11,C,8,5,"div",43)(12,x,8,5,"div",43),e.k0s()()),2&r){const s=e.XpG();e.R7$(2),e.JRh(e.bMT(3,6,"CELL_INFORMATION")),e.R7$(5),e.JRh(e.bMT(8,8,"COORDINATES")),e.R7$(3),e.Lme(" X: ",s.selectedCell.x,", Y: ",s.selectedCell.y," "),e.R7$(),e.Y8G("ngIf",s.selectedCell.player),e.R7$(),e.Y8G("ngIf",s.selectedCell.weapon)}}let k=(()=>{class r{constructor(){this.gameService=(0,e.WQX)(_.w),this.selectedDirection="all",this.teamFilters={all:!0,A:!0,B:!0,C:!0,Joker:!0},this.selectedCell=null,this.canvasWidth=600,this.canvasHeight=600,this.tooltipVisible=!1,this.tooltipX=0,this.tooltipY=0,this.tooltipText="",this.hoverX=0,this.hoverY=0}ngAfterViewInit(){this.initCanvas(),this.drawMap()}onResize(){this.updateCanvasSize()}initCanvas(){this.ctx=this.mapCanvas.nativeElement.getContext("2d"),this.updateCanvasSize(),this.ctx.imageSmoothingEnabled=!1}updateCanvasSize(){const s=this.mapCanvas.nativeElement,n=s.parentElement;if(n){const t=n.getBoundingClientRect();this.canvasWidth=t.width-32,this.canvasHeight=Math.max(400,t.height-32),s.width=this.canvasWidth,s.height=this.canvasHeight,this.drawMap()}}drawMap(){this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),this.drawBackground(),this.drawPlayers(),this.drawWeapons()}drawBackground(){const s=this.ctx.createLinearGradient(0,0,this.canvasWidth,this.canvasHeight);s.addColorStop(0,"#f8fafc"),s.addColorStop(1,"#e2e8f0"),this.ctx.fillStyle=s,this.ctx.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.ctx.strokeStyle="#cbd5e1",this.ctx.lineWidth=1;const n=Math.max(20,Math.min(50,this.canvasWidth/12));for(let t=0;t<=this.canvasWidth;t+=n)this.ctx.beginPath(),this.ctx.moveTo(t,0),this.ctx.lineTo(t,this.canvasHeight),this.ctx.stroke();for(let t=0;t<=this.canvasHeight;t+=n)this.ctx.beginPath(),this.ctx.moveTo(0,t),this.ctx.lineTo(this.canvasWidth,t),this.ctx.stroke()}drawPlayers(){this.gameService.players().forEach(n=>{if(n.coordinates&&this.teamFilters[n.team]){const i=n.coordinates.x/600*this.canvasWidth,a=this.canvasHeight-n.coordinates.y/600*this.canvasHeight,d=Math.max(3,this.canvasWidth/200);this.ctx.shadowColor="rgba(0, 0, 0, 0.3)",this.ctx.shadowBlur=2,this.ctx.shadowOffsetX=1,this.ctx.shadowOffsetY=1,this.ctx.fillStyle=this.getTeamColor(n.team),this.ctx.beginPath(),this.ctx.arc(i,a,d,0,2*Math.PI),this.ctx.fill(),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.fillStyle="white",this.ctx.font=`${Math.max(6,.6*d)}px Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(n.teamNumber||"?",i,a)}})}drawWeapons(){this.gameService.weapons().forEach(n=>{if(n.coordinates){const i=n.coordinates.x/600*this.canvasWidth,a=this.canvasHeight-n.coordinates.y/600*this.canvasHeight,d=Math.max(1.5,this.canvasWidth/400);this.ctx.shadowColor="#fbbf24",this.ctx.shadowBlur=3,this.ctx.fillStyle="#fbbf24",this.ctx.beginPath(),this.ctx.arc(i,a,d,0,2*Math.PI),this.ctx.fill(),this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0}})}getTeamColor(s){switch(s){case"A":return"#ef4444";case"B":return"#3b82f6";case"C":return"#10b981";case"Joker":return"#8b5cf6";default:return"#6b7280"}}onCanvasClick(s){const n=this.mapCanvas.nativeElement.getBoundingClientRect(),o=s.clientY-n.top,i=Math.floor((s.clientX-n.left)/this.canvasWidth*600),a=Math.floor((this.canvasHeight-o)/this.canvasHeight*600),d=this.gameService.players().find(l=>l.coordinates&&Math.abs(l.coordinates.x-i)<5&&Math.abs(l.coordinates.y-a)<5),p=this.gameService.weapons().find(l=>l.coordinates&&Math.abs(l.coordinates.x-i)<5&&Math.abs(l.coordinates.y-a)<5);this.selectedCell={x:i,y:a,player:d,weapon:p}}onCanvasMouseMove(s){const n=this.mapCanvas.nativeElement.getBoundingClientRect(),o=s.clientY-n.top,i=Math.floor((s.clientX-n.left)/this.canvasWidth*600),a=Math.floor((this.canvasHeight-o)/this.canvasHeight*600);this.hoverX=i,this.hoverY=a;const d=this.gameService.players().find(l=>l.coordinates&&Math.abs(l.coordinates.x-i)<5&&Math.abs(l.coordinates.y-a)<5),p=this.gameService.weapons().find(l=>l.coordinates&&Math.abs(l.coordinates.x-i)<5&&Math.abs(l.coordinates.y-a)<5);if(d||p){this.tooltipVisible=!0;const w=n.top+(this.canvasHeight-a/600*this.canvasHeight)-5;this.tooltipX=n.left+i/600*this.canvasWidth+5,this.tooltipY=w;let m=`X: ${i}, Y: ${a}`;d&&(m+=`\nPlayer: ${d.gameName} (${d.uid})`,m+=`\nTeam: ${d.team} - ${d.teamNumber}`,m+=`\nWeapon: ${d.weaponType} (${d.position})`),p&&(m+=`\nWeapon: ${p.weaponType} (${p.position})`),this.tooltipText=m}else this.tooltipVisible=!1}updateTeamFilters(s){if("all"===s){const n=this.teamFilters.all;this.teamFilters.A=n,this.teamFilters.B=n,this.teamFilters.C=n,this.teamFilters.Joker=n}else this.teamFilters.all=this.teamFilters.A&&this.teamFilters.B&&this.teamFilters.C&&this.teamFilters.Joker;this.drawMap()}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-map-view"]],viewQuery:function(n,t){if(1&n&&e.GBs(f,5),2&n){let o;e.mGM(o=e.lsd())&&(t.mapCanvas=o.first)}},hostBindings:function(n,t){1&n&&e.bIt("resize",function(){return t.onResize()},!1,e.tSv)},standalone:!0,features:[e.aNF],decls:120,vars:86,consts:[["mapCanvas",""],[1,"space-y-6","bg-white/90","dark:bg-gray-900/90","backdrop-blur-sm","rounded-lg","p-6","shadow-lg"],[1,"bg-white/95","dark:bg-gray-800/95","backdrop-blur-sm","shadow","rounded-lg","p-4","sm:p-6"],[1,"text-xl","sm:text-2xl","font-bold","text-gray-900","dark:text-white","mb-2"],[1,"text-sm","sm:text-base","text-gray-600","dark:text-gray-400"],[1,"bg-white","dark:bg-gray-800","shadow","rounded-lg","p-4","sm:p-6"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4","sm:gap-6"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900","dark:text-white","mb-3","sm:mb-4"],[1,"space-y-2"],[1,"flex","items-center"],["type","radio","name","direction","value","all","checked","",1,"mr-2",3,"ngModelChange","ngModel"],[1,"text-sm","sm:text-base","text-gray-700","dark:text-gray-300"],["type","radio","name","direction","value","bottom-left",1,"mr-2",3,"ngModelChange","ngModel"],["type","radio","name","direction","value","top-left",1,"mr-2",3,"ngModelChange","ngModel"],["type","radio","name","direction","value","bottom-right",1,"mr-2",3,"ngModelChange","ngModel"],["type","radio","name","direction","value","top-right",1,"mr-2",3,"ngModelChange","ngModel"],["type","checkbox","checked","",1,"mr-2",3,"ngModelChange","change","ngModel"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-4"],[1,"text-base","sm:text-lg","font-semibold","text-gray-900","dark:text-white","mb-2","sm:mb-0"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"relative","bg-gradient-to-br","from-gray-50/95","to-gray-100/95","dark:from-gray-700/95","dark:to-gray-800/95","backdrop-blur-sm","rounded-lg","p-4","sm:p-6","overflow-hidden"],[1,"absolute","inset-0","border-2","border-gray-200/95","dark:border-gray-600/95","backdrop-blur-sm","rounded-lg"],[1,"relative","w-full","h-full","min-h-[400px]","sm:min-h-[500px]","lg:min-h-[600px]"],[1,"w-full","h-full","border","border-gray-300/95","dark:border-gray-600/95","backdrop-blur-sm","rounded-lg","cursor-crosshair","shadow-lg",3,"click","mousemove"],["class","absolute bg-black/95 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-lg pointer-events-none z-10 shadow-lg border border-gray-600/95",3,"left","top",4,"ngIf"],[1,"absolute","top-4","left-4","bg-white/95","dark:bg-gray-800/95","backdrop-blur-sm","rounded-lg","px-3","py-2","text-xs","text-gray-700","dark:text-gray-300","shadow-lg"],[1,"font-semibold"],[1,"mt-6","grid","grid-cols-2","sm:grid-cols-3","lg:grid-cols-5","gap-3","sm:gap-4"],[1,"flex","items-center","space-x-2","bg-gray-50/95","dark:bg-gray-700/95","backdrop-blur-sm","p-2","rounded-lg"],[1,"w-4","h-4","bg-red-500/95","backdrop-blur-sm","rounded-full","shadow-sm"],[1,"text-xs","sm:text-sm","text-gray-700","dark:text-gray-300","font-medium"],[1,"w-4","h-4","bg-blue-500/95","backdrop-blur-sm","rounded-full","shadow-sm"],[1,"w-4","h-4","bg-green-500/95","backdrop-blur-sm","rounded-full","shadow-sm"],[1,"w-4","h-4","bg-purple-500/95","backdrop-blur-sm","rounded-full","shadow-sm"],[1,"w-3","h-3","bg-yellow-500/95","backdrop-blur-sm","rounded-full","shadow-sm"],["class","bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm shadow rounded-lg p-4 sm:p-6",4,"ngIf"],[1,"absolute","bg-black/95","backdrop-blur-sm","text-white","text-xs","px-3","py-2","rounded-lg","pointer-events-none","z-10","shadow-lg","border","border-gray-600/95"],[1,"whitespace-pre-line"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-3","sm:gap-4"],[1,"bg-gray-50/95","dark:bg-gray-700/95","backdrop-blur-sm","p-3","rounded-lg"],[1,"text-xs","sm:text-sm","text-gray-600","dark:text-gray-400","font-medium"],[1,"text-sm","sm:text-lg","font-medium","text-gray-900","dark:text-white"],["class","bg-gray-50/95 dark:bg-gray-700/95 backdrop-blur-sm p-3 rounded-lg",4,"ngIf"],[1,"text-xs","sm:text-sm","text-gray-500","dark:text-gray-400"]],template:function(n,t){if(1&n){const o=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h1",3),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"p",4),e.EFF(6),e.nI1(7,"translate"),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"div",5)(10,"div",6)(11,"div")(12,"h3",7),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"div",8)(16,"label",9)(17,"input",10),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.selectedDirection,a)||(t.selectedDirection=a),e.Njj(a)}),e.k0s(),e.j41(18,"span",11),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"label",9)(22,"input",12),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.selectedDirection,a)||(t.selectedDirection=a),e.Njj(a)}),e.k0s(),e.j41(23,"span",11),e.EFF(24),e.nI1(25,"translate"),e.k0s()(),e.j41(26,"label",9)(27,"input",13),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.selectedDirection,a)||(t.selectedDirection=a),e.Njj(a)}),e.k0s(),e.j41(28,"span",11),e.EFF(29),e.nI1(30,"translate"),e.k0s()(),e.j41(31,"label",9)(32,"input",14),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.selectedDirection,a)||(t.selectedDirection=a),e.Njj(a)}),e.k0s(),e.j41(33,"span",11),e.EFF(34),e.nI1(35,"translate"),e.k0s()(),e.j41(36,"label",9)(37,"input",15),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.selectedDirection,a)||(t.selectedDirection=a),e.Njj(a)}),e.k0s(),e.j41(38,"span",11),e.EFF(39),e.nI1(40,"translate"),e.k0s()()()(),e.j41(41,"div")(42,"h3",7),e.EFF(43),e.nI1(44,"translate"),e.k0s(),e.j41(45,"div",8)(46,"label",9)(47,"input",16),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.teamFilters.all,a)||(t.teamFilters.all=a),e.Njj(a)}),e.bIt("change",function(){return e.eBV(o),e.Njj(t.updateTeamFilters("all"))}),e.k0s(),e.j41(48,"span",11),e.EFF(49),e.nI1(50,"translate"),e.k0s()(),e.j41(51,"label",9)(52,"input",16),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.teamFilters.A,a)||(t.teamFilters.A=a),e.Njj(a)}),e.bIt("change",function(){return e.eBV(o),e.Njj(t.updateTeamFilters("A"))}),e.k0s(),e.j41(53,"span",11),e.EFF(54),e.nI1(55,"translate"),e.k0s()(),e.j41(56,"label",9)(57,"input",16),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.teamFilters.B,a)||(t.teamFilters.B=a),e.Njj(a)}),e.bIt("change",function(){return e.eBV(o),e.Njj(t.updateTeamFilters("B"))}),e.k0s(),e.j41(58,"span",11),e.EFF(59),e.nI1(60,"translate"),e.k0s()(),e.j41(61,"label",9)(62,"input",16),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.teamFilters.C,a)||(t.teamFilters.C=a),e.Njj(a)}),e.bIt("change",function(){return e.eBV(o),e.Njj(t.updateTeamFilters("C"))}),e.k0s(),e.j41(63,"span",11),e.EFF(64),e.nI1(65,"translate"),e.k0s()(),e.j41(66,"label",9)(67,"input",16),e.mxI("ngModelChange",function(a){return e.eBV(o),e.DH7(t.teamFilters.Joker,a)||(t.teamFilters.Joker=a),e.Njj(a)}),e.bIt("change",function(){return e.eBV(o),e.Njj(t.updateTeamFilters("Joker"))}),e.k0s(),e.j41(68,"span",11),e.EFF(69),e.nI1(70,"translate"),e.k0s()()()()()(),e.j41(71,"div",2)(72,"div",17)(73,"h3",18),e.EFF(74),e.nI1(75,"translate"),e.k0s(),e.j41(76,"div",19)(77,"span",20),e.EFF(78),e.nI1(79,"translate"),e.k0s()()(),e.j41(80,"div",21),e.nrm(81,"div",22),e.j41(82,"div",23)(83,"canvas",24,0),e.bIt("click",function(a){return e.eBV(o),e.Njj(t.onCanvasClick(a))})("mousemove",function(a){return e.eBV(o),e.Njj(t.onCanvasMouseMove(a))}),e.k0s(),e.DNE(85,v,3,5,"div",25),e.j41(86,"div",26)(87,"div",27),e.EFF(88),e.nI1(89,"translate"),e.k0s(),e.j41(90,"div"),e.EFF(91),e.nI1(92,"translate"),e.k0s()()()(),e.j41(93,"div",28)(94,"div",29),e.nrm(95,"div",30),e.j41(96,"span",31),e.EFF(97),e.nI1(98,"translate"),e.k0s()(),e.j41(99,"div",29),e.nrm(100,"div",32),e.j41(101,"span",31),e.EFF(102),e.nI1(103,"translate"),e.k0s()(),e.j41(104,"div",29),e.nrm(105,"div",33),e.j41(106,"span",31),e.EFF(107),e.nI1(108,"translate"),e.k0s()(),e.j41(109,"div",29),e.nrm(110,"div",34),e.j41(111,"span",31),e.EFF(112),e.nI1(113,"translate"),e.k0s()(),e.j41(114,"div",29),e.nrm(115,"div",35),e.j41(116,"span",31),e.EFF(117),e.nI1(118,"translate"),e.k0s()()()(),e.DNE(119,R,13,10,"div",36),e.k0s()}2&n&&(e.R7$(3),e.SpI(" ",e.bMT(4,38,"MAP_VIEWER")," "),e.R7$(3),e.Lme(" ",e.bMT(7,40,"MAP_VIEW")," - ",e.bMT(8,42,"GAME_MANAGEMENT")," "),e.R7$(7),e.JRh(e.bMT(14,44,"DIRECTION")),e.R7$(4),e.R50("ngModel",t.selectedDirection),e.R7$(2),e.JRh(e.bMT(20,46,"ALL_DIRECTIONS")),e.R7$(3),e.R50("ngModel",t.selectedDirection),e.R7$(2),e.JRh(e.bMT(25,48,"BOTTOM_LEFT")),e.R7$(3),e.R50("ngModel",t.selectedDirection),e.R7$(2),e.JRh(e.bMT(30,50,"TOP_LEFT")),e.R7$(3),e.R50("ngModel",t.selectedDirection),e.R7$(2),e.JRh(e.bMT(35,52,"BOTTOM_RIGHT")),e.R7$(3),e.R50("ngModel",t.selectedDirection),e.R7$(2),e.JRh(e.bMT(40,54,"TOP_RIGHT")),e.R7$(4),e.JRh(e.bMT(44,56,"TEAM")),e.R7$(4),e.R50("ngModel",t.teamFilters.all),e.R7$(2),e.JRh(e.bMT(50,58,"ALL_DIRECTIONS")),e.R7$(3),e.R50("ngModel",t.teamFilters.A),e.R7$(2),e.JRh(e.bMT(55,60,"TEAM_A")),e.R7$(3),e.R50("ngModel",t.teamFilters.B),e.R7$(2),e.JRh(e.bMT(60,62,"TEAM_B")),e.R7$(3),e.R50("ngModel",t.teamFilters.C),e.R7$(2),e.JRh(e.bMT(65,64,"TEAM_C")),e.R7$(3),e.R50("ngModel",t.teamFilters.Joker),e.R7$(2),e.JRh(e.bMT(70,66,"TEAM_JOKER")),e.R7$(5),e.JRh(e.bMT(75,68,"MAP_VIEWER")),e.R7$(4),e.SpI(" ",e.bMT(79,70,"COORDINATES"),": X: 0-599, Y: 0-599 (0,0 at bottom-left) "),e.R7$(7),e.Y8G("ngIf",t.tooltipVisible),e.R7$(3),e.E5c("",e.bMT(89,72,"COORDINATES"),": X: ",t.hoverX,", Y: ",t.hoverY,""),e.R7$(3),e.JRh(e.bMT(92,74,"CLICK_TO_SELECT")),e.R7$(6),e.JRh(e.bMT(98,76,"TEAM_A")),e.R7$(5),e.JRh(e.bMT(103,78,"TEAM_B")),e.R7$(5),e.JRh(e.bMT(108,80,"TEAM_C")),e.R7$(5),e.JRh(e.bMT(113,82,"TEAM_JOKER")),e.R7$(5),e.JRh(e.bMT(118,84,"WEAPON_TYPE")),e.R7$(2),e.Y8G("ngIf",t.selectedCell))},dependencies:[b.MD,b.bT,c.YN,c.me,c.Zm,c.Fm,c.BC,c.vS,M.h,M.D9],encapsulation:2})}}return r})()}}]);